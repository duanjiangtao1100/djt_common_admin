(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-069632ec"],{"09f4":function(e,t,a){"use strict";a.d(t,"a",function(){return s}),Math.easeInOutQuad=function(e,t,a,n){return e/=n/2,e<1?a/2*e*e+t:(e--,-a/2*(e*(e-2)-1)+t)};var n=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function i(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function o(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function s(e,t,a){var s=o(),l=e-s,r=20,c=0;t="undefined"===typeof t?500:t;var u=function e(){c+=r;var o=Math.easeInOutQuad(c,s,l,t);i(o),c<t?n(e):a&&"function"===typeof a&&a()};u()}},3749:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:e.$t("任务名称")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter(t)}},model:{value:e.listQuery.jobName,callback:function(t){e.$set(e.listQuery,"jobName",t)},expression:"listQuery.jobName"}}),e._v(" "),a("el-select",{staticClass:"filter-item",staticStyle:{width:"110px"},attrs:{placeholder:e.$t("任务状态"),clearable:""},model:{value:e.listQuery.status,callback:function(t){e.$set(e.listQuery,"status",t)},expression:"listQuery.status"}},e._l(e.statusOptions,function(e){return a("el-option",{key:e.key,attrs:{label:e.display_name,value:e.key}})}),1),e._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v(e._s(e.$t("table.search")))]),e._v(" "),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleCreate}},[e._v(e._s(e.$t("table.add")))]),e._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{loading:e.downloadLoading,type:"primary",icon:"el-icon-download"},on:{click:e.handleDownload}},[e._v(e._s(e.$t("table.export")))])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.list,border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:e.$t("任务名称"),prop:"id",sortable:"",align:"center",width:"85"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.jobName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("任务详情"),"min-width":"110px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.description))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("CRON表达式"),"min-width":"70px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.cron))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("执行Service"),prop:"status",sortable:"",width:"160px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.springBeanName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("执行Method"),prop:"expireDate",sortable:"","class-name":"status-col",width:"130px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.methodName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("任务类别"),prop:"status",sortable:"",width:"110px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isSysJob?a("span",{staticStyle:{color:"red"}},[e._v("系统任务")]):a("span",{staticStyle:{color:"springgreen"}},[e._v("常规任务")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("状态"),prop:"status",sortable:"",width:"80px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status?a("span",{staticStyle:{color:"springgreen"}},[e._v("执行中")]):0==t.row.status?a("span",{staticStyle:{color:"red"}},[e._v("已暂停")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("创建时间"),prop:"createDate",sortable:"",width:"140px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("parseTime")(t.row.createTime,"{y}-{m}-{d} {h}:{i}")))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("操作"),align:"center",width:"260","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(a){return e.handleUpdate(t.row,"published")}}},[e._v(e._s(e.$t("修改"))+"\n        ")]),e._v(" "),t.row.status?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleModifyStatus(t.row,0)}}},[e._v(e._s(e.$t("暂停"))+"\n        ")]):t.row.status?e._e():a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleModifyStatus(t.row,1)}}},[e._v(e._s(e.$t("启动"))+"\n        ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v(e._s(e.$t("删除"))+"\n        ")])]}}])})],1),e._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.getList}}),e._v(" "),a("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"dataForm",staticStyle:{width:"600px","margin-left":"50px"},attrs:{rules:e.rules,model:e.temp,"label-position":"left","label-width":"100px"}},[a("el-form-item",{attrs:{label:e.$t("任务名称"),prop:"jobName"}},[a("el-input",{model:{value:e.temp.jobName,callback:function(t){e.$set(e.temp,"jobName",t)},expression:"temp.jobName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("任务详情"),prop:"description"}},[a("el-input",{model:{value:e.temp.description,callback:function(t){e.$set(e.temp,"description",t)},expression:"temp.description"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("CRON表达式"),prop:"cron"}},[a("el-autocomplete",{staticClass:"inline-input",attrs:{"fetch-suggestions":e.querySearchCron,placeholder:"请输入内容"},on:{select:e.handleCronSelect},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.item;return[a("div",{staticClass:"name"},[e._v(e._s(n.value))]),e._v(" "),a("span",{staticClass:"addr"},[e._v(e._s(n.desc))])]}}]),model:{value:e.temp.cron,callback:function(t){e.$set(e.temp,"cron",t)},expression:"temp.cron"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("执行Service"),prop:"springBeanName"}},[a("el-autocomplete",{staticClass:"inline-input",attrs:{"fetch-suggestions":e.querySearchService,placeholder:"请输入内容"},on:{select:e.handleServiceSelect},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.item;return[e._v("\n            "+e._s(a)+"\n          ")]}}]),model:{value:e.temp.springBeanName,callback:function(t){e.$set(e.temp,"springBeanName",t)},expression:"temp.springBeanName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("执行Method"),prop:"methodName"}},[a("el-autocomplete",{staticClass:"inline-input",attrs:{"fetch-suggestions":e.querySearchMethod,placeholder:"请输入内容"},on:{select:e.handleMethodSelect},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.item;return[e._v("\n            "+e._s(a)+"\n          ")]}}]),model:{value:e.temp.methodName,callback:function(t){e.$set(e.temp,"methodName",t)},expression:"temp.methodName"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(e._s(e.$t("取消")))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){"create"===e.dialogStatus?e.createData():e.updateData()}}},[e._v(e._s(e.$t("确定")))])],1)],1)],1)},i=[],o=a("5d73"),s=a.n(o),l=a("5176"),r=a.n(l),c=a("b775");function u(e){return Object(c["a"])({url:"/job/list",method:"get",params:e})}function d(e){return Object(c["a"])({url:"/job/create",method:"post",data:e})}function m(e){return Object(c["a"])({url:"/job/update",method:"put",data:e})}function p(e){return Object(c["a"])({url:"/job/delete/"+e,method:"delete"})}var f=a("6724"),h=a("ed08"),v=a("333d"),b=[{key:"",display_name:"每分钟执行1次"},{key:"",display_name:"每小时执行1次"},{key:"",display_name:"每天执行1次"}],g={name:"License",components:{Pagination:v["a"]},directives:{waves:f["a"]},filters:{statusFilter:function(e){var t={0:"guo",1:"info"};return t[e]}},data:function(){return{tableKey:0,list:null,total:0,listLoading:!0,crons:[],serviceNames:[],methodNames:[],listQuery:{page:1,limit:20,jobName:void 0,status:void 0},showReviewer:!1,cronOptions:b,temp:{id:"'",createTime:"",updateTime:"",jobName:"",description:"",cron:"",springBeanName:"",methodName:"",isSysJob:!1,status:1},dialogFormVisible:!1,dialogStatus:"",textMap:{update:"Edit",create:"Create"},rules:{jobName:[{required:!0,message:"任务名称不得为空",trigger:"blur"}],description:[{required:!0,message:"任务描述不得为空",trigger:"blur"}],cron:[{required:!0,message:"cron表达式不得为空",trigger:"blur"}],springBeanName:[{required:!0,message:"服务类不得为空",trigger:"blur"}],methodName:[{required:!0,message:"方法不得为空",trigger:"blur"}]},downloadLoading:!1}},created:function(){this.getList()},methods:{getList:function(){var e=this;this.listLoading=!0,u(this.listQuery).then(function(t){e.list=t.data.records,e.total=t.data.total,e.listLoading=!1})},handleFilter:function(){this.listQuery.page=1,this.getList()},handleModifyStatus:function(e,t){var a=this;e.status=t;var n=r()({},e);m(n).then(function(){a.$notify({title:"成功",message:"修改成功",type:"success",duration:2e3})})},sortChange:function(e){e.prop,e.order},sortByID:function(e){this.listQuery.sort="ascending"===e?"+id":"-id",this.handleFilter()},resetTemp:function(){this.temp={id:"'",jobName:"",description:"",cron:"",springBeanName:"",methodName:"",isSysJob:!1,status:0,createTime:void 0,updateTime:void 0}},handleCreate:function(){var e=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs["dataForm"].clearValidate()})},createData:function(){var e=this;this.$refs["dataForm"].validate(function(t){if(t){var a=r()({},e.temp);d(a).then(function(){e.dialogFormVisible=!1,e.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3}),e.getList()})}})},handleUpdate:function(e){var t=this;this.temp=r()({},e),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs["dataForm"].clearValidate()})},updateData:function(){var e=this;this.$refs["dataForm"].validate(function(t){if(t){var a=r()({},e.temp);a.createTime=+new Date(a.createTime),a.status=1,m(a).then(function(){var t=!0,a=!1,n=void 0;try{for(var i,o=s()(e.list);!(t=(i=o.next()).done);t=!0){var l=i.value;if(l.id===e.temp.id){var r=e.list.indexOf(l);e.list.splice(r,1,e.temp);break}}}catch(c){a=!0,n=c}finally{try{t||null==o.return||o.return()}finally{if(a)throw n}}e.dialogFormVisible=!1,e.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3})})}})},handleDelete:function(e){var t=this,a=this.list.indexOf(e);this.list.splice(a,1),p(e.id).then(function(){t.dialogFormVisible=!1,t.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3})})},handleDownload:function(){var e=this;this.downloadLoading=!0,Promise.all([a.e("chunk-5bdd67a2"),a.e("chunk-b27dbcdc"),a.e("chunk-58293907")]).then(a.bind(null,"4bf8d")).then(function(t){var a=["timestamp","title","type","importance","status"],n=["timestamp","title","type","importance","status"],i=e.formatJson(n,e.list);t.export_json_to_excel({header:a,data:i,filename:"table-list"}),e.downloadLoading=!1})},formatJson:function(e,t){return t.map(function(t){return e.map(function(e){return"timestamp"===e?Object(h["d"])(t[e]):t[e]})})},formatter:function(e,t){return e.address},querySearchCron:function(e,t){var a=this.crons,n=e?a.filter(this.createFilter(e)):a;t(n)},querySearchService:function(e,t){var a=this.serviceNames,n=e?a.filter(this.createFilter(e)):a;t(n)},querySearchMethod:function(e,t){var a=this.methodNames,n=e?a.filter(this.createFilter(e)):a;t(n)},createFilter:function(e){return function(t){return 0===t.value.toLowerCase().indexOf(e.toLowerCase())}},loadAllCrons:function(){this.crons=[{value:"0/5 * * * * ? ",desc:"每5秒执行1次"},{value:"0 0/5 0 1/1 * ? *",desc:"每5分钟执行1次"},{value:"0 0 0/1 * * ? *",desc:"每1小时执行1次"},{value:"0 0 0 1/1 * ? *",desc:"每1天0:00点执行1次"}]},loadAllServices:function(){this.serviceNames=["logServiceImpl","logServiceImpl","logServiceImpl","logServiceImpl"]},loadAllMethods:function(){this.methodNames=["deleteAllLogs","addUser","deleteAllLogs","deleteAllLogs"]},handleCronSelect:function(e){this.temp.cron=e.value},handleServiceSelect:function(e){this.temp.springBeanName=e},handleMethodSelect:function(e){this.temp.methodName=e,console.log(this.temp.springBeanName+this.temp.cron+this.temp.methodName)}},mounted:function(){this.loadAllCrons(),this.loadAllServices(),this.loadAllMethods()}},y=g,_=a("2877"),w=Object(_["a"])(y,n,i,!1,null,null,null);t["default"]=w.exports},6724:function(e,t,a){"use strict";var n=a("5176"),i=a.n(n),o=(a("8d41"),"@@wavesContext");function s(e,t){function a(a){var n=i()({},t.value),o=i()({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},n),s=o.ele;if(s){s.style.position="relative",s.style.overflow="hidden";var l=s.getBoundingClientRect(),r=s.querySelector(".waves-ripple");switch(r?r.className="waves-ripple":(r=document.createElement("span"),r.className="waves-ripple",r.style.height=r.style.width=Math.max(l.width,l.height)+"px",s.appendChild(r)),o.type){case"center":r.style.top=l.height/2-r.offsetHeight/2+"px",r.style.left=l.width/2-r.offsetWidth/2+"px";break;default:r.style.top=(a.pageY-l.top-r.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",r.style.left=(a.pageX-l.left-r.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return r.style.backgroundColor=o.color,r.className="waves-ripple z-active",!1}}return e[o]?e[o].removeHandle=a:e[o]={removeHandle:a},a}var l={bind:function(e,t){e.addEventListener("click",s(e,t),!1)},update:function(e,t){e.removeEventListener("click",e[o].removeHandle,!1),e.addEventListener("click",s(e,t),!1)},unbind:function(e){e.removeEventListener("click",e[o].removeHandle,!1),e[o]=null,delete e[o]}},r=function(e){e.directive("waves",l)};window.Vue&&(window.waves=l,Vue.use(r)),l.install=r;t["a"]=l},"8d41":function(e,t,a){}}]);